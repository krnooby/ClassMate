# ========================================
# Core Dependencies
# ========================================
numpy==2.2.6                     # 수치 연산 (임베딩, 벡터 연산)
pillow==11.3.0                   # 이미지 처리 (문제 이미지 크롭, 리사이즈)
pydantic==2.11.7                 # FastAPI 데이터 검증
pydantic-settings==2.10.1        # 환경변수 설정 관리
pydantic_core==2.33.2            # Pydantic 핵심 라이브러리
python-dotenv==1.1.1             # .env 파일 로드
PyYAML==6.0.2                    # YAML 설정 파일 파싱
requests==2.32.4                 # HTTP 요청 (외부 API 호출)
python-dateutil==2.9.0.post0     # 날짜/시간 파싱
pytz==2025.2                     # 타임존 처리
tzdata==2025.2                   # 타임존 데이터

# ========================================
# ML & AI - Embedding Model (Qwen3-Embedding-0.6B)
# ========================================
# Used in: src/teacher/shared/embeddings.py, src/shared/services/graph_rag_service.py
torch                            # PyTorch (임베딩 모델 실행)
transformers==4.53.2             # Hugging Face Transformers (Qwen3 모델)
tokenizers==0.21.2               # Fast tokenization
sentencepiece==0.2.0             # SentencePiece tokenizer
safetensors==0.5.3               # 모델 가중치 로드
huggingface-hub==0.34.2          # 모델 다운로드
tiktoken==0.11.0                 # OpenAI tokenizer
regex==2024.11.6                 # 정규표현식 (텍스트 처리)
filelock==3.18.0                 # 파일 잠금
packaging==25.0                  # 패키지 버전 관리
tqdm==4.67.1                     # 진행 표시줄

# CUDA dependencies (GPU 지원 - 선택적)
# EC2에서 GPU 사용 시 필요, CPU-only 환경에서는 자동으로 CPU 사용
nvidia-cublas-cu12==12.6.4.1
nvidia-cuda-cupti-cu12==12.6.80
nvidia-cuda-nvrtc-cu12==12.6.77
nvidia-cuda-runtime-cu12==12.6.77
nvidia-cudnn-cu12==9.5.1.17
nvidia-cufft-cu12==11.3.0.4
nvidia-cufile-cu12==1.11.1.6
nvidia-curand-cu12==10.3.7.77
nvidia-cusolver-cu12==11.7.1.2
nvidia-cusparse-cu12==12.5.4.2
nvidia-cusparselt-cu12==0.6.3
nvidia-nccl-cu12==2.26.2
nvidia-nvjitlink-cu12==12.6.85
nvidia-nvtx-cu12==12.6.77
triton==3.3.1
sympy==1.14.0
mpmath==1.3.0
networkx==3.4.2
fsspec==2025.3.0

# ========================================
# OpenAI API
# ========================================
# Used in: All agent services (student, parent, teacher)
openai==1.99.5                   # OpenAI GPT-4o, o4-mini, TTS-1
pydub==0.25.1                    # TTS 음성 파일 처리 (효과음 믹싱)

# ========================================
# External APIs & Text Analysis
# ========================================
# Used in: src/shared/services/external_api_service.py
textstat==0.7.3                  # 텍스트 난이도 분석 (Flesch Reading Ease, CEFR)
anyio==4.9.0                     # 비동기 I/O
httpx==0.28.1                    # 비동기 HTTP 클라이언트
httpcore==1.0.9                  # HTTP 핵심 라이브러리
h11==0.16.0                      # HTTP/1.1 프로토콜
certifi==2025.7.14               # SSL 인증서
idna==3.10                       # 국제화 도메인명
typing_extensions==4.14.1        # 타입 힌트 확장

# ========================================
# FastAPI Backend
# ========================================
# Used in: src/api/main.py, src/api/routers/*
fastapi>=0.115.0                 # 웹 프레임워크
uvicorn[standard]>=0.31.1        # ASGI 서버
python-multipart>=0.0.9          # 파일 업로드 지원
python-jose[cryptography]>=3.3.0 # JWT 토큰 인증
passlib[bcrypt]>=1.7.4           # 비밀번호 해싱

# FastAPI dependencies
starlette                        # FastAPI 기반 프레임워크
httptools==0.6.4                 # HTTP 파싱 (uvicorn)
uvloop==0.21.0                   # 고성능 이벤트 루프 (uvicorn)
watchfiles==1.1.0                # 파일 변경 감지 (개발 모드)
websockets==15.0.1               # WebSocket 지원
bcrypt==4.3.0                    # Bcrypt 해싱

# ========================================
# Neo4j Database
# ========================================
# Used in: src/api/services/neo4j_service.py, src/shared/services/graph_rag_service.py
neo4j>=5.16.0                    # Neo4j Graph Database 드라이버

# ========================================
# Document Processing
# ========================================
# PDF 파싱: 기본적으로 VLM(OpenAI GPT-4 Vision) 사용 (--parser-mode=vlm, default)
# Used in: src/teacher/parser/pipeline.py, src/teacher/parser/vlm_utils.py
pymupdf>=1.23.0                  # PDF 처리 (fitz) - 필수

# Google Cloud Storage (문제 이미지 업로드용)
google-cloud-storage>=2.10.0     # GCS 이미지 업로드 - 필수
google-auth==2.40.3              # Google Cloud 인증
googleapis-common-protos==1.70.0 # Google API 프로토콜
grpcio==1.74.0                   # gRPC (Google API 통신)
protobuf==6.31.1                 # Protocol Buffers
pyasn1==0.6.1                    # ASN.1 파싱
pyasn1_modules==0.4.2            # ASN.1 모듈
rsa==4.9.1                       # RSA 암호화
cachetools==5.5.2                # 캐싱 유틸리티
requests-oauthlib==2.0.0         # OAuth 인증
urllib3==2.5.0                   # HTTP 라이브러리
oauthlib==3.3.1                  # OAuth 프로토콜

# ========================================
# 시험지 파싱 파이프라인
# ========================================
# 최종 결정: VLM (OpenAI o3) + 한컴 opendataloader bbox 주석 사용
#
# 파싱 파이프라인 (--parser-mode=vlm, default):
#   1. 한컴 opendataloader-pdf (외부 도구): PDF에 bbox 주석 추가
#   2. PyMuPDF (load_annotation_rois): 주석된 bbox 읽기
#   3. VLM (o3): 비전 모델로 문제 파싱 (vlm_parse_exam)
#   4. LLM (o3): 텍스트 매핑 및 정제 (map_with_gpt5)
#
# Document AI는 사용하지 않음:
#   - google-cloud-documentai>=2.20.0  # 사용하지 않음 (주석 처리)
#
# 참고: docai_utils.py는 Document AI와 무관한 유틸리티 함수 포함
#   - load_annotation_rois(): PyMuPDF로 opendataloader 주석 파싱
#   - detect_figures(): PyMuPDF로 이미지 감지
#   - split_items_by_number(): 텍스트 파싱

# ========================================
# 외부 API 서비스 사용 현황
# ========================================
# 아래 서비스들은 이미 구현되어 있으며 정상 작동합니다:
#
# 1. HTTP REST API 서비스 (requests 라이브러리 사용, 추가 pip install 불필요):
#    - YouTubeService: YouTube Data API v3 (src/shared/services/youtube_service.py)
#    - NewsService: NewsAPI (src/shared/services/external_api_service.py)
#    - GrammarCheckService: LanguageTool API (src/shared/services/external_api_service.py)
#    - DictionaryService: Free Dictionary API (src/shared/services/external_api_service.py)
#
# 2. Python 패키지 기반 서비스 (이미 requirements.txt에 포함됨):
#    - TextAnalyzer: textstat==0.7.3 (텍스트 난이도 분석, 65번 줄)
#
# 필요한 환경변수 (API 키):
#    - YOUTUBE_API_KEY: YouTube Data API v3 키
#    - NEWS_API_KEY: NewsAPI.org 키
